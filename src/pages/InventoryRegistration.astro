---
import LayoutSidebar from '../app/LayoutSidebar.astro';
import { getProducts } from '../services/products.ts';

const products = await getProducts();
---

<LayoutSidebar>
	<div class="px-4 pt-6">
		<div class="mb-6">
			<h1 class="text-2xl font-bold text-gray-900 dark:text-white">
				Registro de Inventario
			</h1>
			<p class="text-gray-600 dark:text-gray-400">
				Gestión de piezas y componentes industriales - Maestranzas Unidos S.A.
			</p>
		</div>

		<!-- Formulario de Registro -->
		<div class="p-4 bg-white border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 sm:p-6 dark:bg-gray-800">
			<h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">
				Nuevo Producto
			</h3>
			
			<form class="space-y-6">
				<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
					<!-- Información Básica -->
					<div class="space-y-4">
						<div>
							<label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Nombre del Producto *
							</label>
							<input
								type="text"
								id="name"
								name="name"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
								placeholder="Ej: Rodamiento SKF 6205"
								required
							/>
						</div>
						
						<div>
							<label for="description" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Descripción
							</label>
							<textarea
								id="description"
								name="description"
								rows="3"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
								placeholder="Descripción detallada del producto"
							></textarea>
						</div>
						
						<div>
							<label for="category" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Categoría *
							</label>
							<select
								id="category"
								name="category"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
								required
							>
								<option value="">Seleccionar categoría</option>
								<option value="Rodamientos">Rodamientos</option>
								<option value="Válvulas">Válvulas</option>
								<option value="Lubricantes">Lubricantes</option>
								<option value="Motores">Motores</option>
								<option value="Cables">Cables</option>
								<option value="Bombas">Bombas</option>
								<option value="Filtros">Filtros</option>
								<option value="Sensores">Sensores</option>
								<option value="Cilindros">Cilindros</option>
								<option value="Kits">Kits</option>
								<option value="Terminales">Terminales</option>
								<option value="Herramientas">Herramientas</option>
								<option value="Repuestos">Repuestos</option>
							</select>
						</div>
						
						<div>
							<label for="technology" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Tecnología
							</label>
							<select
								id="technology"
								name="technology"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
							>
								<option value="">Seleccionar tecnología</option>
								<option value="Industrial">Industrial</option>
								<option value="Hidráulica">Hidráulica</option>
								<option value="Eléctrica">Eléctrica</option>
								<option value="Neumática">Neumática</option>
								<option value="Mecánica">Mecánica</option>
								<option value="Electrónica">Electrónica</option>
								<option value="Química">Química</option>
							</select>
						</div>
					</div>
					
					<!-- Información Técnica -->
					<div class="space-y-4">
						<div>
							<label for="serial" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Número de Serie
							</label>
							<input
								type="text"
								id="serial"
								name="serial"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
								placeholder="Ej: SKF-6205-001"
							/>
						</div>
						
						<div>
							<label for="ubicacion" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Ubicación *
							</label>
							<input
								type="text"
								id="ubicacion"
								name="ubicacion"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
								placeholder="Ej: Bodega A - Estante 3"
								required
							/>
						</div>
						
						<div>
							<label for="lote" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Número de Lote
							</label>
							<input
								type="text"
								id="lote"
								name="lote"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
								placeholder="Ej: L2024-001"
							/>
						</div>
						
						<div>
							<label for="vencimiento" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Fecha de Vencimiento
							</label>
							<input
								type="date"
								id="vencimiento"
								name="vencimiento"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
							/>
						</div>
					</div>
				</div>
				
				<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
					<!-- Información de Stock -->
					<div class="space-y-4">
						<div>
							<label for="stock" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Stock Actual *
							</label>
							<input
								type="number"
								id="stock"
								name="stock"
								min="0"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
								placeholder="0"
								required
							/>
						</div>
						
						<div>
							<label for="stockmin" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Stock Mínimo *
							</label>
							<input
								type="number"
								id="stockmin"
								name="stockmin"
								min="0"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
								placeholder="0"
								required
							/>
						</div>
						
						<div>
							<label for="price" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Precio Unitario *
							</label>
							<input
								type="text"
								id="price"
								name="price"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
								placeholder="$0.00"
								required
							/>
						</div>
					</div>
					
					<!-- Información de Proveedor -->
					<div class="space-y-4">
						<div>
							<label for="proveedor" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Proveedor
							</label>
							<input
								type="text"
								id="proveedor"
								name="proveedor"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
								placeholder="Nombre del proveedor"
							/>
						</div>
						
						<div>
							<label for="etiquetas" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Etiquetas
							</label>
							<input
								type="text"
								id="etiquetas"
								name="etiquetas"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
								placeholder="etiqueta1, etiqueta2, etiqueta3"
							/>
						</div>
						
						<div>
							<label for="discount" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
								Descuento
							</label>
							<select
								id="discount"
								name="discount"
								class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
							>
								<option value="No">Sin descuento</option>
								<option value="5%">5%</option>
								<option value="10%">10%</option>
								<option value="15%">15%</option>
								<option value="20%">20%</option>
								<option value="25%">25%</option>
								<option value="30%">30%</option>
							</select>
						</div>
					</div>
				</div>
				
				<div class="flex justify-end space-x-3">
					<button
						type="button"
						class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600"
					>
						Cancelar
					</button>
					<button
						type="submit"
						class="px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
					>
						Registrar Producto
					</button>
				</div>
			</form>
		</div>

		<!-- Tabla de Productos -->
		<div class="mt-6">
			<div class="p-4 bg-white border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 sm:p-6 dark:bg-gray-800">
				<div class="flex items-center justify-between mb-4">
					<h3 class="text-lg font-semibold text-gray-900 dark:text-white">
						Inventario Actual
					</h3>
					<div class="flex space-x-2">
						<input
							type="text"
							placeholder="Buscar productos..."
							class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
						/>
						<button class="px-3 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700">
							Buscar
						</button>
					</div>
				</div>
				
				<div class="overflow-x-auto">
					<table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
						<thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
							<tr>
								<th scope="col" class="px-6 py-3">Producto</th>
								<th scope="col" class="px-6 py-3">Categoría</th>
								<th scope="col" class="px-6 py-3">Stock</th>
								<th scope="col" class="px-6 py-3">Ubicación</th>
								<th scope="col" class="px-6 py-3">Precio</th>
								<th scope="col" class="px-6 py-3">Estado</th>
								<th scope="col" class="px-6 py-3">Acciones</th>
							</tr>
						</thead>
						<tbody>
							{products.slice(0, 10).map(product => (
								<tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700">
									<td class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
										<div>
											<div class="font-medium">{product.name}</div>
											<div class="text-xs text-gray-500">{product.serial}</div>
										</div>
									</td>
									<td class="px-6 py-4">
										<span class="px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full dark:bg-blue-900 dark:text-blue-300">
											{product.category}
										</span>
									</td>
									<td class="px-6 py-4">
										<div class="flex items-center">
											<span class={`font-medium ${
												product.stock <= product.stockmin ? 'text-red-600 dark:text-red-400' : 'text-gray-900 dark:text-white'
											}`}>
												{product.stock}
											</span>
											<span class="text-xs text-gray-500 ml-1">/ {product.stockmin}</span>
										</div>
									</td>
									<td class="px-6 py-4 text-sm text-gray-500 dark:text-gray-400">
										{product.ubicacion}
									</td>
									<td class="px-6 py-4 text-sm text-gray-900 dark:text-white">
										{product.price}
									</td>
									<td class="px-6 py-4">
										<span class={`px-2 py-1 text-xs font-medium rounded-full ${
											product.stock <= product.stockmin ? 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300' :
											product.stock <= product.stockmin * 1.5 ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300' :
											'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300'
										}`}>
											{product.stock <= product.stockmin ? 'Crítico' :
											 product.stock <= product.stockmin * 1.5 ? 'Bajo' : 'Normal'}
										</span>
									</td>
									<td class="px-6 py-4">
										<div class="flex space-x-2">
											<button class="text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300">
												<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
													<path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"></path>
												</svg>
											</button>
											<button class="text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300">
												<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
													<path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path>
												</svg>
											</button>
										</div>
									</td>
								</tr>
							))}
						</tbody>
					</table>
				</div>
				
				<div class="mt-4 flex items-center justify-between">
					<div class="text-sm text-gray-700 dark:text-gray-400">
						Mostrando 1 a 10 de {products.length} productos
					</div>
					<div class="flex space-x-2">
						<button class="px-3 py-1 text-sm text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 dark:bg-gray-700 dark:text-gray-400 dark:border-gray-600 dark:hover:bg-gray-600">
							Anterior
						</button>
						<button class="px-3 py-1 text-sm text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 dark:bg-gray-700 dark:text-gray-400 dark:border-gray-600 dark:hover:bg-gray-600">
							Siguiente
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</LayoutSidebar> 